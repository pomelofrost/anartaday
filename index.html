<!DOCTYPE html>
<html>
    <head>
        <title>ART?</title>
        <style>
            body{margin: 0;}
            canvas {width: 100%; height: 100%;}
        
        </style>
    </head>
    <body>
        <script src="js/three.js"></script>
        <script src="js/OrbitControls.js"></script>
        <script src="js/GLTFLoader.js"></script>
        <script>
            var scene = new THREE.Scene();
            var camera = new THREE.PerspectiveCamera(75, window.innerWidth /window.innerHeight, 0.1, 1000);
            
            var renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);
            
            //resize window
            window.addEventListener('resize', function(){
                var width = window.innerWidth;
                var height = window. innerHeight;
                renderer.setSize(width, height);
                camera.aspect = width/height;
                camera.updateProjectionMatrix();
            });
            
            controls = new THREE.OrbitControls(camera, renderer.domElement);
            
           
            camera. position.z = 280;
            
            var geometry = new THREE.BoxGeometry(400,300,1);
            var cubeMaterials = [
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
                new THREE.MeshBasicMaterial({map: new THREE.TextureLoader().load("img/artwork.jpg"), side: THREE.DoubleSide}),
            ];
            
            var cubeMaterial = new THREE.MeshFaceMaterial(cubeMaterials);
            var cube = new THREE.Mesh (geometry, cubeMaterial);
            cube.position.z = -300;
            scene.add(cube);
            
            //text
            var loader = new THREE.FontLoader();
            loader.load( 'Space_Grotesk_Regular2.json', function ( font ) {
                var xMid, text;
                var color = 0x006699;
                var matDark = new THREE.LineBasicMaterial( {
                    color: color,
                    side: THREE.DoubleSide
                } );
                var matLite = new THREE.MeshBasicMaterial( {
                    color: color,
                    transparent: true,
                    opacity: 0.4,
                    side: THREE.DoubleSide
                } );
            }); //end load
            
            //API REQUEST - BEGIN
            var urlString = "https://collectionapi.metmuseum.org/public/collection/v1/objects/436535";
            var request = new XMLHttpRequest();
            request.open('GET', urlString, true);

            request.onload = function() {
              // Begin accessing JSON data here
              var data = JSON.parse(this.response);
              if (request.status >= 200 && request.status < 400) {
                  console.log(data);
                    
                //TEXT STRING
                var message = data.title + "\n" + data.artistDisplayName;

                var shapes = font.generateShapes( message, 20 );
                var geometry = new THREE.ShapeBufferGeometry( shapes );
                geometry.computeBoundingBox();
                xMid = - 0.5 * ( geometry.boundingBox.max.x - geometry.boundingBox.min.x );
                geometry.translate( xMid, 0, 0 );
                // make shape ( N.B. edge view not visible )
                text = new THREE.Mesh( geometry, matLite );
                text.position.set( 0, 0, -150 ); 
                scene.add( text );

                }
            };
            request.send();
            //PUT EVERYTHING INSIDE API REQUEST - END
                
            
        //frame
            //figure out painting size
            var textureLoader = new THREE.TextureLoader();
            var texture = textureLoader.load( "img/artwork.jpg", function ( texture ) {
                // tex and texture are the same in this example, but that might not always be the case
                console.log( texture.image.width, texture.image.height );
            } );
            
            // lower frame
            var lowerGeometry = new THREE.CubeGeometry(410,10,100);
            var lowerMaterial = new THREE.MeshLambertMaterial( {map: new THREE.TextureLoader().load('img/floor.png'), side: THREE.DoubleSide});
            var lowerCube = new THREE.Mesh (lowerGeometry, lowerMaterial);
            lowerCube.position.y = -150;
            lowerCube.position.z = -300;
            scene.add(lowerCube);
        
            // upper frame
            var upperGeometry = new THREE.CubeGeometry(410,10,100);
            var upperMaterial = new THREE.MeshLambertMaterial( {map: new THREE.TextureLoader().load('img/floor.png'), side: THREE.DoubleSide});
            var upperCube = new THREE.Mesh (upperGeometry, upperMaterial);
            upperCube.position.y = 150;
            upperCube.position.z = -300;
            scene.add(upperCube);
            
            
            //Left frame
            var leftFrameGeometry = new THREE.CubeGeometry(10,300,100);
            var leftFrameMaterial = new THREE.MeshLambertMaterial({map:new THREE.TextureLoader().load('img/floor.png'), side: THREE.DoubleSide});
            var leftFrameCube = new THREE.Mesh(leftFrameGeometry, leftFrameMaterial);
            leftFrameCube.position.x = -200;
            leftFrameCube.position.z = -300;
            scene.add(leftFrameCube);
            
            //Right frame
            var rightFrameGeometry = new THREE.CubeGeometry(10,300,100);
            var rightFrameMaterial = new THREE.MeshLambertMaterial({map:new THREE.TextureLoader().load('img/floor.png'), side: THREE.DoubleSide});
            var rightFrameCube = new THREE.Mesh(rightFrameGeometry, rightFrameMaterial);
            rightFrameCube.position.x =200;
            rightFrameCube.position.z = -300;

            scene.add(rightFrameCube);
            
        //room
            //right wall
            var rightWallGeometry = new THREE.CubeGeometry(10,600,1000);
            var wallMaterial = new THREE.MeshBasicMaterial({map:new THREE.TextureLoader().load('img/wall.png'), side:THREE.DoubleSide});
            var rightWallCube = new THREE.Mesh(rightWallGeometry, wallMaterial);
            rightWallCube.position.x =500;
            rightWallCube.position.z = -200;
            scene.add(rightWallCube);
            
            //leftWall
            var leftWallGeometry = new THREE.CubeGeometry(10,600,1000);
            var leftWallCube = new THREE.Mesh(leftWallGeometry, wallMaterial);
            leftWallCube.position.x =-500;
            leftWallCube.position.z = -200;
            scene.add(leftWallCube);
            
            //ceiling
            var ceilingGeometry = new THREE.CubeGeometry(1000,10,1000);
            var ceilingCube = new THREE.Mesh(ceilingGeometry, wallMaterial);
            ceilingCube.position.x = 0;
            ceilingCube.position.y = -300;
            ceilingCube.position.z = -200;
            scene.add(ceilingCube);
            
            //floor
            var floorGeometry = new THREE.CubeGeometry(1000,10,1000);
            var floorCube = new THREE.Mesh(floorGeometry, wallMaterial);
            floorCube.position.x = 0;
            floorCube.position.y = 300;
            floorCube.position.z = -200;

            scene.add(floorCube);
            
            //backwall
            var backWallGeometry = new THREE.CubeGeometry(1000,600,10);
            var backWallCube = new THREE.Mesh(backWallGeometry, wallMaterial);
            backWallCube.position.x = 0;
            backWallCube.position.z = -400;
            scene.add(backWallCube);
            
            //front
            var backWallGeometry = new THREE.CubeGeometry(1000,600,10);
            var backWallCube = new THREE.Mesh(backWallGeometry, wallMaterial);
            backWallCube.position.x = 0;
            backWallCube.position.z = 300;
            scene.add(backWallCube);
        
        //models
            //plant
            var loader = new THREE.GLTFLoader();

            loader.load( 'obj/indoor_plant/scene.gltf', function ( gltf ) {

                scene.add( gltf.scene );
                gltf.scene.scale.set(30, 30, 30);
                gltf.scene.position.set(200, -250, -200);

            } );
            
            //light
            
            var spotLight = new THREE.SpotLight( 0xffffff );
            spotLight.position.set( 0, -50, -50 );

            spotLight.castShadow = true;

            spotLight.shadow.mapSize.width = 1024;
            spotLight.shadow.mapSize.height = 1024;

            spotLight.shadow.camera.near = 500;
            spotLight.shadow.camera.far = 500;
            spotLight.shadow.camera.fov = 30;

            scene.add( spotLight );
            
            var ambientLight = new THREE.AmbientLight( 0xFFFFFF,0.5);
            scene.add(ambientLight);

            
            
            //game logic
            var update = function(){
//                cone.rotation.x += 0.01;
//                cone.rotation.y += 0.005;
//                cone.rotation.z += 0.005;
            };
            
            // draw scene
            var render = function(){
                renderer.render( scene, camera);
            };
            
            // run game loop (update, render, repeat)
            var GameLoop = function(){
                requestAnimationFrame(GameLoop);
                
                update();
                render();
                
            };
            
            GameLoop(); 
        </script>
    </body>
</html>